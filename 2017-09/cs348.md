# CS 348: Databases

Professor: Grant Weddell

## 1. Introduction

- Data is facts.
- We mainly deal with **persistent**, not **volatile** data.
- Data: Large persistent collection of information with efficient get and update.
- Database management system: Set of programs that manage a database.
- Schema: how data is organized
- Three level schema architecture:
  - External (view): What applications see
  - Conceptual: Logical structure of data
  - Physical: Files, devices, storage algorithms
- Data independence: DBMS provides an abstract data model
  - Physical: immune to changes in storage structures
  - Logical: immune to changes in data organization
- Transaction: Application-specified atomic, durable unit of work
- ACID:
  - Atomic: all or nothing
  - Consistent: makes sense
  - Isolated: non-interfering
  - Durable: changes stay
- Data definition language (DDL): for schemas
- Data manipulation language (DML): for queries and updates

## 2. The relational model

- All information is organized in a number of relations.
- Components:
  - Universe: Set of values D, with quality (=)
  - Relation:
    - schema: name R, arity k
    - instance: relation R sube D^k
  - Database:
    - schema: set of relation schemes
    - instance: relation Ri for Ri
  - Notation: signature rho = (R1, ..., Rn), instance D = (D, =, R1, ..., Rn)
- Valuation: Maps variable names to values in the universe.
- Complete semantics: TODO, involves |=
- Integrity constraints: Stuff that must be true in a valid database instance
- View: An integrity constraint that extends the DB schema, creating a virtual table
- Unsafe queries: Can have infinite answers.
- Domain-independent query: Satisfies a thing. (TODO)
  - Thm: Answers to these queries only contain values that exist in R1, ..., Rk (the active domain)
- Range-restricted query: A class of domain-independent queries.
  - diq can be rewritten as an equivalent rrq.
- Computational properties
  - Relational calculus is not Turing complete, since every query evaluation terminates
  - **Data complexity**: complexity in the size of the database for a *fixed query*
    - in PTIME, LOGSPACE, ACâ‚€
  - **Combined complexity**: in PSPACE, but not PTIME (You can express SAT)
- TODO: A bunch of stuff went over your head, review this later

## 3. SQL

- Three parts of the language:
  - DML: Data manipulation language
  - DDL: Data definition language
  - DLC: Data control language
- SQL data types: integer, smallint, decimal(m,n), float, char(n), varchar(n), date, time
- SELECT results FROM tables WHERE condition
  - `SELECT DISTINCT * FROM author;`
    - Selects all authors
  - `SELECT DISTINCT r1.publication FROM wrote r1, wrote r2 WHERE r1.publication = r2.publication and r1.author != r2.author;
    - Selects all publications with at least two authors
  - `SELECT DISTINCT title FROM publication, book WHERE publication.pubid = book.pubid`
    - Selects titles of all books
- UNION, EXCEPT, INTERSECT
  - Set operations
  - Use like: `(select distinct pubid from book) union (select distinct pubid from journal)
- WITH
  - Used for subqueries
  - Use like: `WITH thing AS (SELECT xxx) SELECT yyy FROM thing`
  - Can also subquery inline: `SELECT yyy FROM (SELECT xxx)`
- First-order SQL shortcomings
  - Some queries are hard to write (need syntactic sugar)
  - No counting (need aggregation)
  - No "path in graph" (need recursion)
- WHERE subqueries
  - WHERE attr IN ( Q )
  - WHERE attr NOT IN ( Q )
  - WHERE attr op SOME ( Q )
  - WHERE attr op ALL ( Q )
  - WHERE EXISTS ( Q )
  - WHERE NOT EXISTS ( Q )
  - Parametric subqueries: basically you can access upper scope
- Bag operations
  - UNION ALL
  - EXCEPT ALL
  - INTERSECT ALL
